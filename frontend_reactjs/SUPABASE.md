# Supabase Integration (Frontend)

This app uses Supabase for storing SOW drafts and templates.

Environment variables (see .env.example):
- REACT_APP_SUPABASE_URL
- REACT_APP_SUPABASE_KEY
- REACT_APP_SITE_URL (optional, used for auth redirect flows)

Client initialization:
- src/supabaseClient.js uses createClient(REACT_APP_SUPABASE_URL, REACT_APP_SUPABASE_KEY)

Tables (provisioned via automated setup):
1) sows
- id: bigint (pk, generated by default as identity)
- title: text
- template: text
- content: text
- created_at: timestamptz not null default now()

2) templates
- id: uuid (pk, default gen_random_uuid())
- name: text not null
- type: text (e.g., FP or TM)
- body: text
- updated_at: timestamptz not null default now()

Security
- RLS is enabled on sows and templates.
- Development policies allow anonymous read/write to support the current demo UX.
- For production, replace with user-restricted policies using auth.uid() checks.

Frontend utilities:
- Dynamic URL helper: src/utils/getURL.js, used to construct redirect URLs safely.
- Optional auth callback route: src/pages/auth/AuthCallback.jsx

Usage in code:
- Export step can "Save to Supabase" (src/pages/ExportPDF.jsx) via supabase.from("sows").insert(...)
- Templates Manager uses supabase.from("templates") for create/list/update/delete (src/pages/TemplatesManager.jsx)

Setup Instructions:
1. Create .env from .env.example and set values:
   - REACT_APP_SUPABASE_URL
   - REACT_APP_SUPABASE_KEY
   - REACT_APP_SITE_URL (optional, used for auth redirects)
2. In Supabase Dashboard (if enabling auth):
   - Authentication > URL Configuration
   - Set Site URL to your domain or http://localhost:3000 for local
   - Add Redirect URLs: http://localhost:3000/** and your production domain /**
3. Rebuild the app after env changes:
   - npm install
   - npm start

Notes:
- If you change table names/columns, update code in ExportPDF.jsx and TemplatesManager.jsx accordingly.
