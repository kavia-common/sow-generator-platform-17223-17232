{"is_source_file": true, "format": "JavaScript (ES Modules)", "description": "This file provides a set of functions for handling DOCX template merging, including placeholder extraction, strict interpolation, and packaging into DOCX format. It includes mechanisms to load templates, extract placeholders, perform interpolation, generate DOCX files, and package files into ZIP archives.", "external_files": ["fetch API (built-in in browsers)", "zip and crc32 utility functions (encoded within the file)"], "external_methods": ["fetch()"], "published": ["getLatestTemplateAttachmentPaths", "loadTemplateTranscript", "extractPlaceholders", "interpolateTranscriptStrict", "mapUserDataForTemplateStrict", "generateDocxFromTranscriptLines", "zipSync"], "classes": [], "methods": [{"name": "getLatestTemplateAttachmentPaths()", "description": "Returns the latest paths for template attachments categorized by template type (e.g., FP, TM).", "scope": "", "scopeKind": ""}, {"name": "loadTemplateTranscript(templateType)", "description": "Asynchronously loads the template transcript text for a specified template type by fetching from candidate URLs.", "scope": "", "scopeKind": ""}, {"name": "extractPlaceholders(transcriptText)", "description": "Finds all [Field] and <Field> placeholders in the transcript text and returns a list of unique placeholders with normalized keys.", "scope": "", "scopeKind": ""}, {"name": "interpolateTranscriptStrict(transcriptText, mapping)", "description": "Replaces placeholders in the transcript with corresponding user-provided values, leaving placeholders unchanged if no value is provided.", "scope": "", "scopeKind": ""}, {"name": "mapUserDataForTemplateStrict(data)", "description": "Provides a mapping function to retrieve user data values based on placeholder labels, with support for aliases and authorization signatures.", "scope": "", "scopeKind": ""}, {"name": "generateDocxFromTranscriptLines(mergedTranscript, { logoDataUrl } = {})", "description": "Generates a basic DOCX structure with transcript lines properly wrapped as XML, optionally embedding a logo image.", "scope": "", "scopeKind": ""}, {"name": "zipSync(fileMap)", "description": "Packages a set of files into a ZIP blob suitable for DOCX packaging.", "scope": "", "scopeKind": ""}, {"name": "crc32(bytes)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "dataUrlToBytes(dataUrl)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "escapeXml(s)", "scope": "generateDocxFromTranscriptLines", "scopeKind": "function", "description": "unavailable"}, {"name": "friendly(v)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "inlineImageXml(relId, widthPx, heightPx)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "normalizeKey(label)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "replaceToken(full, inner)", "scope": "interpolateTranscriptStrict", "scopeKind": "function", "description": "unavailable"}, {"name": "tryResolveAltKey(key, templateData)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "writeUint16(arr, pos, val)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "writeUint32(arr, pos, val)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["fetch", "normalizeKey", "friendly", "tryResolveAltKey", "dataUrlToBytes", "inlineImageXml", "crc32"], "search-terms": ["strictDocxTemplateMergeService", "extractPlaceholders", "interpolateTranscriptStrict", "loadTemplateTranscript", "generateDocxFromTranscriptLines", "zipSync", "placeholder extraction", "DOCX template merging", "template attachment paths"], "state": 2, "file_id": 61, "knowledge_revision": 374, "git_revision": "3c937a3a367c499b826afa9df74704ecf19eac7f", "revision_history": [{"288": ""}, {"374": "3c937a3a367c499b826afa9df74704ecf19eac7f"}], "ctags": [{"_type": "tag", "name": "client_name", "path": "/home/kavia/workspace/code-generation/sow-generator-platform-17223-17232/frontend_reactjs/src/services/strictDocxTemplateMergeService.js", "pattern": "/^    client_name: 'client_company_name',$/", "language": "JavaScript", "kind": "property", "scope": "tryResolveAltKey.map", "scopeKind": "class"}, {"_type": "tag", "name": "crc32", "path": "/home/kavia/workspace/code-generation/sow-generator-platform-17223-17232/frontend_reactjs/src/services/strictDocxTemplateMergeService.js", "pattern": "/^function crc32(bytes) {$/", "language": "JavaScript", "kind": "function", "signature": "(bytes)"}, {"_type": "tag", "name": "dataUrlToBytes", "path": "/home/kavia/workspace/code-generation/sow-generator-platform-17223-17232/frontend_reactjs/src/services/strictDocxTemplateMergeService.js", "pattern": "/^function dataUrlToBytes(dataUrl) {$/", "language": "JavaScript", "kind": "function", "signature": "(dataUrl)"}, {"_type": "tag", "name": "end_date", "path": "/home/kavia/workspace/code-generation/sow-generator-platform-17223-17232/frontend_reactjs/src/services/strictDocxTemplateMergeService.js", "pattern": "/^    end_date: 'end_date',$/", "language": "JavaScript", "kind": "property", "scope": "tryResolveAltKey.map", "scopeKind": "class"}, {"_type": "tag", "name": "engagement_number", "path": "/home/kavia/workspace/code-generation/sow-generator-platform-17223-17232/frontend_reactjs/src/services/strictDocxTemplateMergeService.js", "pattern": "/^    engagement_number: 'engagement_number',$/", "language": "JavaScript", "kind": "property", "scope": "tryResolveAltKey.map", "scopeKind": "class"}, {"_type": "tag", "name": "escapeXml", "path": "/home/kavia/workspace/code-generation/sow-generator-platform-17223-17232/frontend_reactjs/src/services/strictDocxTemplateMergeService.js", "pattern": "/^  function escapeXml(s) {$/", "language": "JavaScript", "kind": "function", "signature": "(s)", "scope": "generateDocxFromTranscriptLines", "scopeKind": "function"}, {"_type": "tag", "name": "extractPlaceholders", "path": "/home/kavia/workspace/code-generation/sow-generator-platform-17223-17232/frontend_reactjs/src/services/strictDocxTemplateMergeService.js", "pattern": "/^export function extractPlaceholders(transcriptText) {$/", "language": "JavaScript", "kind": "function", "signature": "(transcriptText)"}, {"_type": "tag", "name": "friendly", "path": "/home/kavia/workspace/code-generation/sow-generator-platform-17223-17232/frontend_reactjs/src/services/strictDocxTemplateMergeService.js", "pattern": "/^function friendly(v) {$/", "language": "JavaScript", "kind": "function", "signature": "(v)"}, {"_type": "tag", "name": "generateDocxFromTranscriptLines", "path": "/home/kavia/workspace/code-generation/sow-generator-platform-17223-17232/frontend_reactjs/src/services/strictDocxTemplateMergeService.js", "pattern": "/^export function generateDocxFromTranscriptLines(mergedTranscript, { logoDataUrl } = {}) {$/", "language": "JavaScript", "kind": "function", "signature": "(mergedTranscript, { logoDataUrl } = {})"}, {"_type": "tag", "name": "getLatestTemplateAttachmentPaths", "path": "/home/kavia/workspace/code-generation/sow-generator-platform-17223-17232/frontend_reactjs/src/services/strictDocxTemplateMergeService.js", "pattern": "/^export function getLatestTemplateAttachmentPaths() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "inlineImageXml", "path": "/home/kavia/workspace/code-generation/sow-generator-platform-17223-17232/frontend_reactjs/src/services/strictDocxTemplateMergeService.js", "pattern": "/^function inlineImageXml(relId, widthPx, heightPx) {$/", "language": "JavaScript", "kind": "function", "signature": "(relId, widthPx, heightPx)"}, {"_type": "tag", "name": "interpolateTranscriptStrict", "path": "/home/kavia/workspace/code-generation/sow-generator-platform-17223-17232/frontend_reactjs/src/services/strictDocxTemplateMergeService.js", "pattern": "/^export function interpolateTranscriptStrict(transcriptText, mapping) {$/", "language": "JavaScript", "kind": "function", "signature": "(transcriptText, mapping)"}, {"_type": "tag", "name": "loadTemplateTranscript", "path": "/home/kavia/workspace/code-generation/sow-generator-platform-17223-17232/frontend_reactjs/src/services/strictDocxTemplateMergeService.js", "pattern": "/^export async function loadTemplateTranscript(templateType) {$/", "language": "JavaScript", "kind": "function", "signature": "(templateType)"}, {"_type": "tag", "name": "map", "path": "/home/kavia/workspace/code-generation/sow-generator-platform-17223-17232/frontend_reactjs/src/services/strictDocxTemplateMergeService.js", "pattern": "/^  const map = {$/", "language": "JavaScript", "kind": "class", "scope": "tryResolveAltKey", "scopeKind": "class"}, {"_type": "tag", "name": "mapUserDataForTemplateStrict", "path": "/home/kavia/workspace/code-generation/sow-generator-platform-17223-17232/frontend_reactjs/src/services/strictDocxTemplateMergeService.js", "pattern": "/^export function mapUserDataForTemplateStrict(data) {$/", "language": "JavaScript", "kind": "function", "signature": "(data)"}, {"_type": "tag", "name": "normalizeKey", "path": "/home/kavia/workspace/code-generation/sow-generator-platform-17223-17232/frontend_reactjs/src/services/strictDocxTemplateMergeService.js", "pattern": "/^function normalizeKey(label) {$/", "language": "JavaScript", "kind": "function", "signature": "(label)"}, {"_type": "tag", "name": "replaceToken", "path": "/home/kavia/workspace/code-generation/sow-generator-platform-17223-17232/frontend_reactjs/src/services/strictDocxTemplateMergeService.js", "pattern": "/^  function replaceToken(full, inner) {$/", "language": "JavaScript", "kind": "function", "signature": "(full, inner)", "scope": "interpolateTranscriptStrict", "scopeKind": "function"}, {"_type": "tag", "name": "scope_of_work", "path": "/home/kavia/workspace/code-generation/sow-generator-platform-17223-17232/frontend_reactjs/src/services/strictDocxTemplateMergeService.js", "pattern": "/^    scope_of_work: 'scope_of_work',$/", "language": "JavaScript", "kind": "property", "scope": "tryResolveAltKey.map", "scopeKind": "class"}, {"_type": "tag", "name": "start_date", "path": "/home/kavia/workspace/code-generation/sow-generator-platform-17223-17232/frontend_reactjs/src/services/strictDocxTemplateMergeService.js", "pattern": "/^    start_date: 'start_date',$/", "language": "JavaScript", "kind": "property", "scope": "tryResolveAltKey.map", "scopeKind": "class"}, {"_type": "tag", "name": "supplier_name", "path": "/home/kavia/workspace/code-generation/sow-generator-platform-17223-17232/frontend_reactjs/src/services/strictDocxTemplateMergeService.js", "pattern": "/^    supplier_name: 'supplier_name',$/", "language": "JavaScript", "kind": "property", "scope": "tryResolveAltKey.map", "scopeKind": "class"}, {"_type": "tag", "name": "table", "path": "/home/kavia/workspace/code-generation/sow-generator-platform-17223-17232/frontend_reactjs/src/services/strictDocxTemplateMergeService.js", "pattern": "/^const table = (() => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "tryResolveAltKey", "path": "/home/kavia/workspace/code-generation/sow-generator-platform-17223-17232/frontend_reactjs/src/services/strictDocxTemplateMergeService.js", "pattern": "/^function tryResolveAltKey(key, templateData) {$/", "language": "JavaScript", "kind": "function", "signature": "(key, templateData)"}, {"_type": "tag", "name": "writeUint16", "path": "/home/kavia/workspace/code-generation/sow-generator-platform-17223-17232/frontend_reactjs/src/services/strictDocxTemplateMergeService.js", "pattern": "/^function writeUint16(arr, pos, val) {$/", "language": "JavaScript", "kind": "function", "signature": "(arr, pos, val)"}, {"_type": "tag", "name": "writeUint32", "path": "/home/kavia/workspace/code-generation/sow-generator-platform-17223-17232/frontend_reactjs/src/services/strictDocxTemplateMergeService.js", "pattern": "/^function writeUint32(arr, pos, val) {$/", "language": "JavaScript", "kind": "function", "signature": "(arr, pos, val)"}, {"_type": "tag", "name": "zipSync", "path": "/home/kavia/workspace/code-generation/sow-generator-platform-17223-17232/frontend_reactjs/src/services/strictDocxTemplateMergeService.js", "pattern": "/^export function zipSync(fileMap) {$/", "language": "JavaScript", "kind": "function", "signature": "(fileMap)"}], "hash": "5f67c2c92776a1a11992e9d8a23b1aaa", "format-version": 4, "code-base-name": "frontend_reactjs", "filename": "frontend_reactjs/src/services/strictDocxTemplateMergeService.js", "fields": [{"name": "client_name: 'client_company_name',", "scope": "tryResolveAltKey.map", "scopeKind": "class", "description": "unavailable"}, {"name": "end_date: 'end_date',", "scope": "tryResolveAltKey.map", "scopeKind": "class", "description": "unavailable"}, {"name": "engagement_number: 'engagement_number',", "scope": "tryResolveAltKey.map", "scopeKind": "class", "description": "unavailable"}, {"name": "scope_of_work: 'scope_of_work',", "scope": "tryResolveAltKey.map", "scopeKind": "class", "description": "unavailable"}, {"name": "start_date: 'start_date',", "scope": "tryResolveAltKey.map", "scopeKind": "class", "description": "unavailable"}, {"name": "supplier_name: 'supplier_name',", "scope": "tryResolveAltKey.map", "scopeKind": "class", "description": "unavailable"}]}